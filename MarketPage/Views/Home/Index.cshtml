@{
    ViewData["Title"] = "Home Page";
    var activeCarousel = true;
}

<div class="container ">
    <div class="row mt-1 justify-content-center">
        <h4 class="text-center ml-3 mb-1 mt-3" style="color:#4c1130"><i class="fas fa-star pr-2"></i>Destaques<i class="fas fa-star pl-2"></i></h4>
    </div>
    @* Alerta Controller TempData*@
    <div class="row justify-content-center">
        @if (TempData["Message"] != null)
        {
            <div class="alert alert-info" role="alert">
                @TempData["Message"].ToString()
            </div>
        }
    </div>

    @foreach (var categoria in @ViewBag.Categorias)
    {
        @if (activeCarousel)
        {
            <div class="row ml-lg-5 mb-2 mt-5">
                <h5 class="ml-5" style="color:#741b47">@categoria.Nome<i class="fas fa-store-alt pl-2"></i></h5>
            </div>
            <div class="row justify-content-md-center">
                <div id="carouselExampleFade" class="carousel slide carousel-fade col-10" data-ride="carousel" style="background-color: white">
                    <div class="carousel-inner">
                        @foreach (var item in @ViewBag.Itens)
                        {
                            //Formata imagem
                            var base64 = Convert.ToBase64String(item.Img);
                            var imgSrc = String.Format("data:image/gif;base64,{0}", base64);

                            //Formata nome do item
                            var nomeView = string.Empty;
                            if (item.Nome.Length > 20)
                                nomeView = $"{item.Nome.Substring(0, 16)}...";
                            else
                            {
                                nomeView = item.Nome;
                            }
                            @if (item.IdCategoria == categoria.Id)
                            {
                                @if (activeCarousel)
                                {<div class="carousel-item active">

                                        <div class="row d-flex justify-content-center align-items-center">
                                            <div class="col text-right">
                                                <a style="cursor:pointer" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">
                                                    <img class="mt-3" src='@imgSrc' style="width: 250px; height: 250px; " />
                                                </a>
                                            </div>
                                            <div class="col">
                                                <label class="text-body mb-1" style="font-size:20px;">
                                                    <a class="text-secondary" style="cursor:pointer" title="@item.Nome" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">@nomeView</a>
                                                </label>
                                                <div class="text-capitalize" style="font-size:18px;"><strong>R$@item.Valor</strong></div>
                                                @{
                                                    var valorParcelado = (item.Valor / 12).ToString("00.00");
                                                }
                                                <div class="text-capitalize text-secondary" style="font-size:16px;">Ou 12x de R$@valorParcelado</div>
                                                <div class="text-left">
                                                    <a class="btn btn-outline-secondary btn-sm mt-2 mb-2" style="cursor:pointer" title="Compra / Adicionar ao carrinho" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">
                                                        <i class="fas fa-shopping-cart mr-2"></i>Ver mais
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div> }
                                else
                                {<div class="carousel-item ">
                                        <div class="row d-flex justify-content-center align-items-center">
                                            <div class="col text-right">
                                                <a style="cursor:pointer" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">
                                                    <img class="mt-3" src='@imgSrc' style="width:250px; height:250px;" />
                                                </a>
                                            </div>
                                            <div class="col">
                                                <label class="text-body mb-1" style="font-size:20px;">
                                                    <a class="text-secondary" style="cursor:pointer" title="@item.Nome" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">@nomeView</a>
                                                </label>
                                                <div class="text-capitalize" style="font-size:18px;"><strong>R$@item.Valor</strong></div>
                                                @{
                                                    var valorParcelado = (item.Valor / 12).ToString("00.00");
                                                }
                                                <div class="text-capitalize text-secondary" style="font-size:16px;">Ou 12x de R$@valorParcelado</div>
                                                <div class="text-left">
                                                    <a class="btn btn-outline-secondary btn-sm mt-2 mb-2" style="cursor:pointer" title="Compra / Adicionar ao carrinho" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">
                                                        <i class="fas fa-shopping-cart mr-2"></i>Ver mais
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>}
                                @if (activeCarousel) { activeCarousel = false; }
                            }
                        }
                    </div>
                    <a class="carousel-control-prev text-dark" href="#carouselExampleFade" role="button" data-slide="prev">
                        <h3>
                            <i class="fas fa-arrow-circle-left"></i>
                        </h3>
                        <span class="sr-only text-secondary">Anterior</span>
                    </a>
                    <a class="carousel-control-next text-dark" href="#carouselExampleFade" role="button" data-slide="next">
                        <h3><i class="fas fa-arrow-circle-right"></i></h3>
                        <span class="sr-only text-secondary">Proximo</span>
                    </a>
                </div>
            </div>
        }
        else
        {
            <div class="ml-lg-5">
                <div class="row ml-lg-5 mb-2 mt-5">
                    <h5 style="color:#741b47">@categoria.Nome<i class="fas fa-store-alt pl-2"></i></h5>
                </div>
                <div class="card-deck ml-1">
                    @foreach (var item in @ViewBag.Itens)
                    {
                        @if (item.IdCategoria == categoria.Id)
                        {
                            <div class="col-md-3 col-sm-6 mt-2">
                                <div class="card">
                                    <div class="container h-100 d-flex justify-content-center">
                                        @{
                                            //Formata imagem
                                            var base64 = Convert.ToBase64String(item.Img);
                                            var imgSrc = String.Format("data:image/gif;base64,{0}", base64);

                                            //Formata nome do item
                                            var nomeView = string.Empty;
                                            if (item.Nome.Length > 20)
                                                nomeView = $"{item.Nome.Substring(0, 16)}...";
                                            else
                                            {
                                                nomeView = item.Nome;
                                            }
                                        }
                                        <a style="cursor:pointer" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">
                                            <img class="mt-3" src='@imgSrc' style="width:150px; height:150px;" />
                                        </a>
                                    </div>
                                    <div class="content ml-3 mr-3 mb-3">
                                        <label class="text-body mb-1" style="font-size:18px;">
                                            <a class="text-secondary" style="cursor:pointer" title="@item.Nome" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">@nomeView</a>
                                        </label>
                                        <div class="text-capitalize" style="font-size:16px;"><strong>R$@item.Valor</strong></div>
                                        @{
                                            var valorParcelado = (item.Valor / 12).ToString("00.00");
                                        }
                                        <div class="text-capitalize text-secondary" style="font-size:14px;">Ou 12x de R$@valorParcelado</div>
                                        <div class="text-center">
                                            <a class="btn btn-outline-secondary btn-sm mt-2" style="cursor:pointer" title="Compra / Adicionar ao carrinho" onclick="@("window.location.href='" + @Url.Action("Index", "Produto",new { item.Id }) + "'");">
                                                <i class="fas fa-shopping-cart mr-2"></i>Ver mais
                                            </a>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            </div>

        }
    }
</div>


